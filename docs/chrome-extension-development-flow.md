# Chrome拡張機能 開発から公開までの完全ガイド

## 概要
Chrome拡張機能を独自開発し、Chrome Web Storeで公開するまでの詳細な手順を解説します。

## 1. 開発準備（所要時間: 30分）

### 1.1 プロジェクトディレクトリの作成
```bash
mkdir rubylingo
cd rubylingo

# 最小構成ファイルの作成
touch manifest.json
touch content.js
touch background.js
touch popup.html
```

### 1.2 開発環境の準備
- テキストエディタ（VS Code推奨）
- Google Chrome（最新版）
- Git（バージョン管理用）

## 2. ローカル開発（所要時間: 1-2週間）

### 2.1 必須ファイル構成
```
rubylingo/
├── manifest.json      # 拡張機能の設定ファイル
├── content.js         # Webページ操作スクリプト
├── background.js      # バックグラウンド処理
├── popup.html         # ポップアップUI
├── popup.js           # ポップアップのロジック
├── popup.css          # ポップアップのスタイル
└── icons/             # アイコンファイル
    ├── icon16.png
    ├── icon48.png
    └── icon128.png
```

### 2.2 manifest.json の基本構造
```json
{
  "manifest_version": 3,
  "name": "RubyLingo",
  "version": "1.0.0",
  "description": "日本語Webページに英訳ルビを自動挿入",
  "permissions": ["activeTab", "storage"],
  "action": {
    "default_popup": "popup.html",
    "default_icon": {
      "16": "icons/icon16.png",
      "48": "icons/icon48.png",
      "128": "icons/icon128.png"
    }
  },
  "content_scripts": [
    {
      "matches": ["<all_urls>"],
      "js": ["content.js"]
    }
  ],
  "background": {
    "service_worker": "background.js"
  }
}
```

### 2.3 開発手順
1. **manifest.json作成**: バージョン、権限、スクリプト設定
2. **基本機能実装**: content.js でDOM操作ロジック
3. **UI実装**: popup.html/js でON/OFF制御
4. **状態管理**: Chrome Storage APIで設定保存
5. **デバッグ・改善**: 実サイトでテスト

## 3. ローカルテスト（随時実施）

### 3.1 拡張機能の読み込み
1. Chromeを開く
2. アドレスバーに `chrome://extensions/` を入力
3. 右上の「デベロッパーモード」をON
4. 「パッケージ化されていない拡張機能を読み込む」をクリック
5. 開発フォルダ（rubylingo）を選択

### 3.2 テスト手順
- 各種Webサイトで動作確認
- コンソールでエラーチェック
- パフォーマンス測定
- メモリ使用量確認

### 3.3 更新方法
1. コードを修正
2. chrome://extensions/ で「更新」ボタンクリック
3. ページをリロードして確認

## 4. 公開準備（所要時間: 2-3日）

### 4.1 必要な素材
- **アイコン**: 
  - 128x128px（ストア表示用）
  - 48x48px（拡張機能管理画面用）
  - 16x16px（ツールバー用）
- **スクリーンショット**:
  - 1280x800px または 640x400px
  - 最低1枚、最大5枚
  - 実際の動作画面をキャプチャ
- **プロモーション画像**（任意）:
  - 440x280px タイル画像

### 4.2 テキスト準備
- **拡張機能名**: 45文字以内
- **短い説明**: 132文字以内
- **詳細説明**: 
  - 機能説明
  - 使い方
  - 特徴
  - 更新履歴
- **プライバシーポリシー**: データ収集について明記

### 4.3 多言語対応
- 英語は必須
- 日本語版も用意推奨
- _locales/ フォルダで管理

## 5. デベロッパー登録（初回のみ）

### 5.1 登録手順
1. [Chrome Web Store Developer Dashboard](https://chrome.google.com/webstore/developer/dashboard) にアクセス
2. Googleアカウントでログイン
3. 開発者登録料 $5 を支払い（クレジットカード必要）
4. 開発者情報を入力

### 5.2 必要情報
- メールアドレス
- 開発者名（公開される）
- 支払い情報

## 6. ストア申請（所要時間: 1-2日）

### 6.1 パッケージ作成
```bash
# 不要ファイルを除外してZIP化
zip -r rubylingo.zip . -x ".*" -x "__MACOSX" -x "*.DS_Store"
```

### 6.2 アップロード手順
1. Developer Dashboardで「新しいアイテム」クリック
2. rubylingo.zipをアップロード
3. 必要情報を入力:
   - **カテゴリー**: 生産性、教育など
   - **言語**: 日本語、英語
   - **地域**: 配信地域を選択
   - **価格**: 無料/有料設定

### 6.3 ストア掲載情報
- アイコン、スクリーンショットアップロード
- 説明文入力（マークダウン使用可）
- プライバシーポリシーURL（必要な場合）
- サポート連絡先

## 7. 審査プロセス（所要時間: 1-7日）

### 7.1 審査の流れ
1. **自動審査**: 数時間〜1日
   - マニフェスト検証
   - セキュリティチェック
   - ポリシー違反確認
2. **手動審査**: 1-7日（権限による）
   - 特定の権限使用時
   - ランダムサンプリング

### 7.2 審査基準
- Chrome Web Store ポリシー準拠
- 適切な権限使用
- 明確な機能説明
- ユーザープライバシー保護

### 7.3 却下時の対応
- 却下理由を確認
- 問題箇所を修正
- 再申請（通常24時間以内）

## 8. 公開後の運用

### 8.1 ユーザーサポート
- レビューへの返信
- バグレポート対応
- 機能リクエスト管理

### 8.2 アップデート
1. コード修正
2. manifest.jsonのバージョン更新
3. 新しいZIPファイル作成
4. Dashboardからアップロード
5. 自動的にユーザーに配信

### 8.3 分析・改善
- インストール数の追跡
- ユーザーレビュー分析
- クラッシュレポート確認
- 使用統計の活用

## 9. RubyLingo固有の注意事項

### 9.1 権限について
- `activeTab`権限のみ使用で審査は迅速
- 全サイト対象(`<all_urls>`)の場合は理由を明確に
- storage権限は設定保存に必須

### 9.2 コンテンツポリシー
- 教育目的であることを強調
- 翻訳精度についての免責事項
- 第三者コンテンツへの影響を説明

### 9.3 パフォーマンス
- 大量DOM操作による負荷を考慮
- 遅延読み込みの実装推奨
- メモリリーク対策必須

## 10. よくある問題と解決策

### 10.1 審査での却下理由
- **権限の過剰要求**: 最小限の権限に
- **説明不足**: 機能を詳細に記載
- **品質問題**: 十分なテスト実施

### 10.2 技術的な課題
- **CSPエラー**: content_scriptsで外部リソース使用制限
- **非同期処理**: Promise/async-awaitの適切な使用
- **メモリ管理**: 不要なリスナーの削除

### 10.3 ユーザーからのフィードバック
- 低評価レビューには迅速対応
- 共通の問題はFAQ作成
- 定期的なアップデートで信頼性向上

## まとめ

Chrome拡張機能の開発は、適切な手順を踏めば個人開発者でも十分可能です。RubyLingoのようなシンプルな機能であれば、2-3週間での公開が現実的です。重要なのは：

1. **ユーザー価値の明確化**: 何を解決するか
2. **シンプルな実装**: 複雑な機能は避ける
3. **十分なテスト**: 実環境での動作確認
4. **継続的な改善**: ユーザーフィードバックを活かす

開発を始める前に、この文書を通読し、全体の流れを把握することをお勧めします。