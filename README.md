# 日本語ルビ英訳 Chrome拡張機能 仕様書

## 1. 概要

### 1.1 プロダクト名
RubyLingo (Chrome Extension)

### 1.2 コンセプト
**「あらゆるWebページを瞬時に英語学習教材に変換」**

日本語で書かれたWebページ（ニュース、ブログ、SNS等）を形態素解析し、各単語に英訳ルビを自動挿入。普段のブラウジングを英語学習時間に変える。

### 1.3 対象ユーザー
- 日常的にWebブラウジングする日本人
- 隙間時間で英語学習したい人
- 大量の英単語に触れたい学習者

## 2. 核心機能

### 2.1 基本動作
1. Webページの日本語テキストを検出
2. 形態素解析でトークン分割
3. 各トークンに英訳ルビを挿入
4. 元のページレイアウトを維持

### 2.2 動作例
**変換前:**
```
今日は良い天気ですね。
```

**変換後:**
```html
<ruby>今日<rt>today</rt></ruby><ruby>は<rt>TOP</rt></ruby><ruby>良い<rt>good</rt></ruby><ruby>天気<rt>weather</rt></ruby><ruby>です<rt>is</rt></ruby><ruby>ね<rt>right</rt></ruby>。
```

## 3. 機能仕様

### 3.1 Chrome拡張機能構成
```
manifest.json          # 拡張機能設定
content-script.js       # ページ内容操作
background.js          # バックグラウンド処理
popup.html/js/css      # 設定UI
options.html/js/css    # 詳細設定画面
```

### 3.2 コア機能

#### 3.2.1 テキスト検出・変換
- **対象**: `<p>`, `<span>`, `<div>`, `<h1-h6>`, `<li>` 等のテキストノード
- **除外**: `<script>`, `<style>`, `<code>`, `<pre>`, 入力フォーム
- **処理**: 日本語を含むテキストノードのみ処理

#### 3.2.2 形態素解析
- **エンジン**: kuromoji.js (JavaScript形態素解析器)
- **辞書**: Browser環境で動作する軽量辞書
- **分割粒度**: 基本形での分割

#### 3.2.3 英訳ルビ挿入
- **方式**: HTMLの`<ruby>`タグ使用
- **翻訳源**: 内蔵単語辞書（高頻出語 + 基本語彙）
- **フォールバック**: 翻訳不可能な語は元のまま表示

### 3.3 ユーザーインターフェース

#### 3.3.1 ブラウザアクション（ポップアップ）
```
┌─────────────────┐
│ RubyLingo       │
│                 │
│ ○ ON  ○ OFF    │
│                 │
│ 助詞表示: ☑    │
│ 活用表示: ☑    │
│                 │
│ [オプション]     │
└─────────────────┘
```

#### 3.3.2 オプション画面
- 対象サイトの包含/除外設定
- ルビフォントサイズ調整
- 表示色カスタマイズ
- ショートカットキー設定

## 4. 技術仕様

### 4.1 使用技術
- **JavaScript**: ES2020+
- **形態素解析**: kuromoji.js
- **翻訳辞書**: JSON形式の静的辞書
- **ストレージ**: Chrome Storage API

### 4.2 パフォーマンス要件
- **初回読み込み**: 3秒以内でルビ表示完了
- **メモリ使用量**: 50MB以下
- **CPU負荷**: ページ表示を阻害しない軽量処理

### 4.3 データ構造

#### 4.3.1 翻訳辞書
```json
{
  "今日": "today",
  "天気": "weather",
  "良い": "good",
  "は": "TOP",
  "です": "is"
}
```

#### 4.3.2 設定データ
```json
{
  "enabled": true,
  "showParticles": true,
  "showInflection": true,
  "fontSize": "small",
  "excludeDomains": ["example.com"]
}
```

## 5. 実装優先度

### 5.1 MVP（最小実装）
- [ ] 基本的な形態素解析
- [ ] 高頻出1000語の英訳辞書
- [ ] ルビ表示機能
- [ ] ON/OFF切り替え

### 5.2 Phase 2
- [ ] 助詞・活用の適切な処理
- [ ] 除外サイト設定
- [ ] ルビデザイン改善

### 5.3 Phase 3
- [ ] 学習履歴機能
- [ ] 辞書の動的拡張
- [ ] ユーザー辞書機能

## 6. 開発制約

### 6.1 技術制約
- Chrome拡張機能のセキュリティ制限
- クライアントサイド処理のみ（サーバー不使用）
- 外部API呼び出し制限（オフライン動作）

### 6.2 パフォーマンス制約
- ページ読み込み速度への影響最小化
- 大量テキストページでの処理速度
- モバイル端末での動作

## 7. ユーザーストーリー

### 7.1 メインユース
**「ニュースサイトで自然に英語学習」**
```
1. Yahoo!ニュースにアクセス
2. 拡張機能が自動でルビを表示
3. 記事を読みながら自然に英単語を覚える
4. 興味ある話題で語彙が増える
```

### 7.2 サブユース
- **ブログ読書**: 好きなブロガーの記事で学習
- **SNS学習**: TwitterやInstagramの投稿で語彙増強
- **技術記事**: プログラミング記事で専門用語習得

## 8. 差別化ポイント

### 8.1 既存ツールとの違い
- **リアルタイム性**: ページ閲覧と同時に学習
- **コンテキスト保持**: 元記事の文脈で学習
- **選択性なし**: あらゆるサイトが対象
- **継続性**: 特別な学習時間不要

### 8.2 学習効果
- **大量インプット**: 1日数百～数千の英単語に接触
- **自然な文脈**: 生きた日本語文章での学習
- **継続しやすさ**: 普段の行動に学習が組み込まれる

## 9. リリース計画

### 9.1 開発期間
- **MVP開発**: 2-3週間
- **テスト・改善**: 1週間
- **ストア申請**: 1週間

### 9.2 検証指標
- **インストール数**: 初月100人
- **アクティブ利用率**: 週3回以上利用50%
- **ユーザーフィードバック**: 平均4.0以上

### 10.1 プラットフォーム拡張
- モバイルアプリ版
